<!DOCTYPE html>
<html lang='zh-CN'>
<head>
<title>Tips - Noodles 的维基</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="static/css/style.css" media="screen" type="text/css">
<link rel="stylesheet" href="static/highlight/styles/solarized_dark.css">
</head>
<body>
<header id="header"> <div class="meta inner">
        <h1><a href=".">Wiki</a></h1>
        <nav id="main-nav">
            <ul>
                <li> <a href="http://blog.mark42.net" target="_blank">Blog</a> </li>
                <li><a href="./about-me.html">About-Me</a></li>
            </ul>
            <div class="clearfix"></div>
        </nav>
    </div>
    <div class="clearfix"></div>
</header>
<div id="content" class="inner">
    <div id="main-col" class="alignleft">
        <div id="wrapper">
            <article class="post">
                <div class="post-content">
                    <header>
                        <h1 class="title">Tips</h1>
                    </header>
                    <div class="entry">
                        

<h3 id="toc_0.0.1">dig 输出“干净”的结果</h3>

<pre class="bash">
dig +noall +answer wiki.mark42.net
wiki.mark42.net.	566	IN	A	116.251.209.185
</pre>

<pre>
dig +noall +answer mark42.net ns

mark42.net.        231 IN  NS  ns4.dnsv5.com.
mark42.net.        231 IN  NS  ns3.dnsv5.com.
</pre>

<p>
域名放在 dig 的参数后面，参数顺序也不要变，因为后面的参数“覆盖”前面的参数。
当 <code>dig +short</code> 输出的信息不够，并且需要批量处理一些东西时，这样的输出结果应该更方便操作
</p>


<h3 id="toc_0.0.2">yum 安装指定版本的包</h3>
<h4 id="toc_0.0.2.1">场景:</h4>

<p>
为了编译一个内核模块，需要安装 kernel-devel, 执行 <code>yum install kernel-devel</code>, 安装之后仍然无法编译内核模块。
</p>

<p>
因为内核版本与 kernel-devel 版本不一致，内核是旧版的，可能因为一些原因不能升级内核，这时需要安装旧版本的 kernel-devel。
</p>

<p>
<code>uname -r</code> 结果是 <code>2.6.32-431.el6.x86_64</code>, <code>/usr/src/kernel/</code> 目录里的是 <code>2.6.32-431.11.2.el6.x86_64</code>
</p>

<h4 id="toc_0.0.2.2">步骤:</h4>

<ol>
<li>
查看这个包都有哪些版本 <code>yum --showduplicates list kernel-devel</code>,  找到跟内核版本一致的包
<pre class="bash">
[vagrant@vagrant-centos65 kernels]$ yum --showduplicates list kernel-devel
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
Installed Packages
kernel-devel.x86_64               2.6.32-431.11.2.el6                   @updates
Available Packages
kernel-devel.x86_64               2.6.32-431.el6                        base    
kernel-devel.x86_64               2.6.32-431.1.2.0.1.el6                updates 
kernel-devel.x86_64               2.6.32-431.3.1.el6                    updates 
kernel-devel.x86_64               2.6.32-431.5.1.el6                    updates 
kernel-devel.x86_64               2.6.32-431.11.2.el6                   updates
</pre>

<li>
删除已安装的 kernel-devel <code>sudo yum remove kernel-devel</code>

<li>
安装旧版 <code>sudo yum install kernel-devel-2.6.32-431.el6</code>

</ol>


<h3 id="toc_0.0.3">Cent OS 系统保存 iptables 规则</h3>
<p>
<code>sudo service iptables save</code>
输出
</p>

<p>
<code>iptables: Saving firewall rules to /etc/sysconfig/iptables:[  OK  ]</code>
</p>

<h3 id="toc_0.0.4">stat file</h3>
<pre class="bash">
Access: 2014-06-09 10:30:55.395091685 +0800
Modify: 2014-05-16 18:23:40.151899468 +0800
Change: 2014-05-16 18:23:40.179899469 +0800
</pre>
<ul>
<li>
Access 是文件最近一次被访问的时间

<li>
Modify 是文件内容最近一次被修改的时间

<li>
Change 是文件树形最近一次被修改的时间

</ul>


<h3 id="toc_0.0.5">用户“私有 hosts 文件”</h3>
<pre class="bash">
echo '8.8.8.8 google-dns' &gt;&gt; ~/.hosts
export HOSTALIASES=~/.hosts
telnet google-dns 53
</pre>

<p>
通过环境变量 <code>HOSTALIASES</code> 指定“私有 hosts 文件”的路径（可以在 .profile, .bashrc 这类文件里设置该变量）
</p>

<p>
以下两种情况 <strong>不适用</strong> ：
</p>
<ul>
<li>
程序在解析域名时没有用 <code>getaddrinfo</code> 或 <code>gethostbyname</code>

<li>
程序中通过 <code>setuid</code> 以其他用户运行

</ul>

<h3 id="toc_0.0.6">使用 rsync 续传文件</h3>
<p>
scp 时如果遇到一些情况导致文件传输过程终端，scp 退出，重新执行 scp 后，会重头开始重新传输。使用 rsync 可以进行断点续传
</p>
<pre class="bash">
rsync --partial --progress --rsh='ssh' /path/to/file user@dsthost:/dst/path/
</pre>

<p>
<code>--partial --progress</code> 可以用 <code>-P</code> 来代替
</p>

                    </div>
                </div>
            </article>
        </div>
    </div>
    <div class="clearfix"></div>
</div>
<footer id="footer">
    <div class="inner">
        <div class="alignleft">
            <p>
            Generated by <a href="http://www.vim.org/scripts/script.php?script_id=2226">vimwiki</a> and <a href="http://bootswatch.com">Bootswatch</a>.
            </p>
        </div>
        <div class="clearfix"></div>
    </div>
</footer>
<script type="text/javascript" src="http://tajs.qq.com/stats?sId=32074356" charset="UTF-8"></script>
<script src="http://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
<script src="static/highlight/highlight.pack.js"></script>
<script type="text/javascript">
$(document).ready(function() {
        $('pre').each(function(i, e) {hljs.highlightBlock(e)});
        });
hljs.configure({
languages: []
})
hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-37422134-12']);
_gaq.push(['_trackPageview']);
(function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();
</script>
</body>
</html>
